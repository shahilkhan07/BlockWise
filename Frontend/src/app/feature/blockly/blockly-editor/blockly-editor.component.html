<div class="container">
  <div class="floating-particles">
    <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
    <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
    <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
    <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
    <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
    <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
    <div class="particle" style="left: 70%; animation-delay: 0.5s;"></div>
    <div class="particle" style="left: 80%; animation-delay: 1.5s;"></div>
    <div class="particle" style="left: 90%; animation-delay: 2.5s;"></div>
  </div>

  <div class="header">
    <p>Transform your ideas into visual code blocks with AI-powered assistance</p>
  </div>
  <div *ngIf="!isLoggedIn" class="signin-reminder">
    <p>
      🔐 <span>Sign in</span> to track your daily challenges and progress.
      <a routerLink="/auth/sign-in" class="signin-link">Sign in now →</a>
    </p>
  </div>

  <div class="daily-challenge-widget">
    <button class="challenge-btn" (click)="startChallenge()">
      {{ currentChallenge ? 'Close' : '🎯 Challenge Yourself' }}
    </button>

    <div class="challenge-viewer" *ngIf="currentChallenge">
      <div class="section-title">
        <span class="icon">🧠</span>
        {{ currentChallenge.question }}
      </div>

      <div class="challenge-actions">
        <button (click)="useChallenge(currentChallenge.question)">Use</button>
        <button (click)="toggleHint()">💡 Hint</button>
        <button (click)="nextChallenge()">➡ Next</button>
      </div>

      <p *ngIf="showHintText" class="hint-text">
        {{ currentChallenge.hint }}
      </p>
    </div>
  </div>

  <div class="main-content">

    <div class="left-panel">
      <div class="input-section">
        <div class="section-title">
          <div class="icon">💡</div>
          Describe Your Project
        </div>

        <textarea [(ngModel)]="userPrompt" class="prompt-textarea"
          placeholder="Tell me what you want to build... For example: 'For loop to print 1 to 10'"></textarea>

        <button class="btn btn-primary" (click)="generateBlocks()">
          <span>🚀</span> Generate Blocks
          <div class="loading" id="generateLoading" style="display: none;"></div>
        </button>
      </div>

      <div class="output-section">
        <div class="section-title">
          <div class="icon">⚡</div>
          Execute & Results
        </div>

        <button class="btn btn-success" (click)="runBlocks()">
          <span>▶</span> Run Code
        </button>

        <div class="tabs">
          <div class="tab" [class.active]="activeTab === 'code'" (click)="activeTab = 'code'">JavaScript Code</div>
          <div class="tab" [class.active]="activeTab === 'output'" (click)="activeTab = 'output'">Console Output</div>
        </div>

        <div *ngIf="activeTab === 'code'">
          <div class="code-block">{{ generatedCode || '// Generated JavaScript code will appear here' }}</div>
        </div>
        <div *ngIf="activeTab === 'output'">
          <div class="output-block">{{ executionOutput || '$ Ready to execute code\n> Waiting for blocks to be
            generated...' }}</div>
        </div>
      </div>
    </div>

    <div class="right-panel">
      <div class="section-title">
        <div class="icon">🔧</div>
        Visual Workspace
      </div>

      <div class="workspace-container">
        <div #blocklyDiv id="blocklyDiv" style="height: 100%; width: 100%;"></div>
      </div>
    </div>
  </div>
</div>